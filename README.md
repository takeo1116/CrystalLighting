# CrystalLighting

TopCoder Open2018 Marathon Match round2 CrystalLighting の提出コードとテスター/ビジュアライザのセットです。
CrystalLighting.cppは実際にコンテストに提出したコード、exeファイルはそれをコンパイルした実行ファイルになります。
CrystalLightingVis.javaおよびtester.jarはコンテスト運営より配布されたものであり、自作ではありません。

## 問題文およびコードの概要
問題文については、[TopCoderの問題文](https://community.topcoder.com/longcontest/?module=ViewProblemStatement&rd=17179&pm=14934)
を、コードの概要に関しては[参加記](http://takeo1116.sakura.ne.jp/marathon/TCOMMR2diary.html)
をご参照ください。

## 問題の概略
はじめに、初期状態が生成されます。
初期状態は、ランダムに決定された以下のような情報をもちます
- 盤面の大きさ
    - 10×10 から 100×100 の間でランダムに決定されます。
- クリスタルの配置
    - 各クリスタルは色の情報をもっており、青, 黃, 赤 および 緑(青+黃), 紫(青+赤), 橙(黃+赤) の6色があります。
- 障害物の配置
    - 最初から配置されている障害物は取り除くことができません。
- ランタン, 鏡, 障害物の設置コスト
    - 後述するランタン, 鏡, 障害物は1つ設置するごとに減点されます。このコストもある範囲内でランダムに決定されます。
- 鏡、障害物の最大数
    - 鏡と障害物は無尽蔵に置けるわけではなく、最大数があらかじめ決められています。

これに対して、参加者が作成したプログラムは、ランタン、鏡、障害物の3つのアイテムを設置し、獲得スコアを最大化することを目指します。

- ランタン
    - ランタンを置くと、ランタンの四方に光線が発射されます。この光線がクリスタルに当たるとクリスタルを照らすことができます。
        - クリスタルを正しい色に照らすと加点されます。青、黃、赤は+20点、緑、紫、橙は+30点になります。ランタンの色は青、黃、赤の3種類なので、30点を得るためには2種類の光を入射させる必要があります。
        - クリスタルを誤った色に照らしてしまうと-10点になります。
        - また、ランタンから出た光線が別のランタンに入射している部分が盤面の中に1箇所でもあると無効な解となり、全体のスコアが-1000000点になってしまいます。
    - 鏡は二種類の向き(／, ＼)があり、どちらかを選んで置くことができます。ランタンの光が鏡に当たると、反射されて向きが90度変化します。
    - 障害物にランタンの光が入射すると、そこで止まります。別のランタンや意図しないクリスタルに光が入射してしまうことを防ぐ効果があります。

## ビジュアライザの使いかた
ディレクトリをローカルにコピーし、ディレクトリ内でコマンド

<div> java -jar tester.jar -exec "./CrystalLighting.exe" -seed <seed> </div>

を実行すると、任意のseed値で生成された問題に対する解を確認することができます。seed : 1などは比較的小さい盤面のため、見やすくおすすめになります。大きい盤面ではseed : 4などは横長なのでこれも見やすいです。

## ビジュアライザの見かた
上記のコマンドを実行すると、別窓で盤面が表示されます。これは入力したseed値に対応した初期状態であり、この時点で盤面にはクリスタルと障害物しかありませんが、裏でCrystalLighting.exeが動いており、約10秒後に計算結果が表示されます。このとき、右上のMARK,LAYSボタンを押すと、正しい色に照らされたクリスタルの位置や、ランタンから出る光線を可視化することができます。